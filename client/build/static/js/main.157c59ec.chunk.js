(this.webpackJsonptask_4=this.webpackJsonptask_4||[]).push([[0],{40:function(e,t,a){e.exports=a(70)},45:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(18),l=a.n(c),s=(a(45),a(14)),u=a(10),o=(a(50),a(11)),i=a(1),m=a.n(i),d=a(3);function p(){}var f=Object(n.createContext)({token:null,userId:null,login:p,logout:p,isAuthenticated:!1}),b=function(){return r.a.createElement("div",{className:"loader-loading"},r.a.createElement("div",{className:"preloader-wrapper active"},r.a.createElement("div",{className:"spinner-layer spinner-red-only"},r.a.createElement("div",{className:"circle-clipper left"},r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"gap-patch"},r.a.createElement("div",{className:"circle"})),r.a.createElement("div",{className:"circle-clipper right"},r.a.createElement("div",{className:"circle"})))))},E=b,h=a(6),v=a(4),k=a(36),g=a.n(k),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=g.a.create({baseURL:e,headers:{"content-type":"application/json"}}),a=function(e){t.defaults.headers.common.Authorization="Bearer ".concat(e)},n=function(){var e=Object(d.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(n),e.prev=1,e.next=4,t.get("/api/users");case 4:if(401!==(r=e.sent).status){e.next=7;break}throw new Error("No authorization.");case 7:return e.abrupt("return",r);case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),r=function(){var e=Object(d.a)(m.a.mark((function e(n,r){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(r),e.prev=1,e.next=4,t.delete("/api/users/delete/".concat(n));case 4:if(401!==(c=e.sent).status){e.next=7;break}throw new Error("No authorization.");case 7:return e.abrupt("return",c);case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,a){return e.apply(this,arguments)}}(),c=function(){var e=Object(d.a)(m.a.mark((function e(n,r){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(r),e.prev=1,e.next=4,t.post("/api/users/block/".concat(n));case 4:if(401!==(c=e.sent).status){e.next=7;break}throw new Error("No authorization.");case 7:return e.abrupt("return",c);case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,a){return e.apply(this,arguments)}}(),l=function(){var e=Object(d.a)(m.a.mark((function e(n,r){var c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(r),e.prev=1,e.next=4,t.post("/api/users/unlock/".concat(n));case 4:if(401!==(c=e.sent).status){e.next=7;break}throw new Error("No authorization.");case 7:return e.abrupt("return",c);case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t,a){return e.apply(this,arguments)}}(),s=function(e){a(e),t.get("/api/users/logout")},u=function(){var e=Object(d.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.post("/api/auth/login",Object(v.a)({},n));case 2:return r=e.sent,a(r.token),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{auth:u,getUsers:n,deleteById:r,blockById:c,unlockById:l,logoutRequest:s}},O=function(e){return{type:"FETCH_USERS_SUCCESS",payload:e}},j=function(e){return{type:"FETCH_USERS_FAILURE",payload:e}},x=function(e){return function(t){t({type:"FETCH_USERS_REQUEST"}),w().getUsers(e).then((function(e){var a=e.data;t(O(a))})).catch((function(e){throw t(j(e)),e}))}},N=function(e){var t=e.users,a=Object(n.useState)(!1),c=Object(h.a)(a,2),l=c[0],s=c[1],o=Object(u.b)();Object(n.useEffect)((function(){s(t.length===t.filter((function(e){return!0===e.checked})).length)}),[t]);var i=function(e){if(e){var t=new Date(e).toLocaleString("en-US",{timeZone:"Europe/Minsk"});return(t=new Date(t)).toLocaleString()}return e};return r.a.createElement("table",{className:"responsive-table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",{className:"main-checkbox"},r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",className:"filled-in checkbox-blue-grey",checked:l,onChange:function(){o({type:"EDIT_USER_ALL_CHECKBOX"}),s((function(e){return!e}))}}),r.a.createElement("span",null))),r.a.createElement("th",null,"ID"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"email"),r.a.createElement("th",null,"Date of registration"),r.a.createElement("th",null,"Date of last authorization"),r.a.createElement("th",null,"Status"))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",{className:"checkbox-table-row"},r.a.createElement("label",null,r.a.createElement("input",{type:"checkbox",className:"filled-in checkbox-blue-grey",checked:e.checked,onChange:(t=e.id,function(){o({type:"EDIT_USER_CHECKBOX",payload:t})})}),r.a.createElement("span",null))),r.a.createElement("td",null,e.id),r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.email),r.a.createElement("td",null,i(e.dateRegister)),r.a.createElement("td",null,i(e.dateLastAuthorization)),r.a.createElement("td",null,e.status));var t}))))},y=function(){return Object(n.useCallback)((function(e){window.M&&e&&window.M.toast({html:e})}),[])},S=function(){var e=Object(n.useContext)(f),t=e.token,a=e.logout,c=Object(u.c)((function(e){return e})).usersReducer.users,l=Object(u.b)(),s=y(),o=function(){var e=Object(d.a)(m.a.mark((function e(){var n,r,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0===(n=c.filter((function(e){return!0===e.checked}))).length){e.next=16;break}if(0===n.filter((function(e){return"Blocked"!==e.status})).length){e.next=15;break}return r=JSON.parse(localStorage.getItem("userData")).userId,u=n.find((function(e){return e.id===r})),e.next=9,Promise.all(n.map((function(e){return w().blockById(e.id,t)})));case 9:if(!u){e.next=12;break}return s("Your account is blocked."),e.abrupt("return",a());case 12:l(x(t)),e.next=16;break;case 15:1===n.length?s("User is already blocked."):s("Users are already blocked.");case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),s("Your account is blocked or deleted."),a();case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(d.a)(m.a.mark((function e(){var n,r,u;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0===(n=c.filter((function(e){return!0===e.checked}))).length){e.next=11;break}return r=JSON.parse(localStorage.getItem("userData")).userId,u=n.find((function(e){return e.id===r})),e.next=7,Promise.all(n.map((function(e){return w().deleteById(e.id,t)})));case 7:if(!u){e.next=10;break}return s("Your account is deleted."),e.abrupt("return",a());case 10:l(x(t));case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),s("Your account is blocked or deleted."),a();case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Object(d.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,0===(n=c.filter((function(e){return!0===e.checked}))).length){e.next=11;break}if(0===n.filter((function(e){return"Blocked"===e.status})).length){e.next=10;break}return e.next=7,Promise.all(n.map((function(e){return w().unlockById(e.id,t)})));case 7:l(x(t)),e.next=11;break;case 10:1===n.length?s("User is not blocked."):s("Users are not blocked.");case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),s("Your account is blocked or deleted."),a();case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement("div",{className:"toolbar-buttons"},r.a.createElement("button",{className:"waves-effect red accent-1 btn",onClick:o},"Block"),r.a.createElement("i",{className:"medium material-icons",onClick:p},"lock_open"),r.a.createElement("i",{className:"medium material-icons",onClick:i},"delete"))},C=function(){var e=Object(u.c)((function(e){return e.usersReducer})),t=e.users,a=e.loading,c=e.error,l=Object(n.useContext)(f),s=l.token,o=l.logout,i=Object(u.b)();return Object(n.useEffect)((function(){(function(){var e=Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i({type:"FETCH_USERS_REQUEST"}),e.next=4,w().getUsers(s);case 4:t=e.sent,i(O(t.data)),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),i(j(e.t0)),o();case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}})()()}),[i,o,s]),a?r.a.createElement(E,null):c?r.a.createElement("div",{className:"center"},"Unexpected error. Please try again."):r.a.createElement(n.Fragment,null,r.a.createElement(S,null),r.a.createElement(N,{users:t}))},U=a(16),I=function(){var e=Object(n.useState)(!1),t=Object(h.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(null),l=Object(h.a)(c,2),s=l[0],u=l[1];return{loading:a,request:Object(n.useCallback)(function(){var e=Object(d.a)(m.a.mark((function e(t){var a,n,c,l,s,o=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o.length>1&&void 0!==o[1]?o[1]:"GET",n=o.length>2&&void 0!==o[2]?o[2]:null,c=o.length>3&&void 0!==o[3]?o[3]:{},r(!0),e.prev=4,n&&(n=JSON.stringify(n),c["Content-Type"]="application/json"),e.next=8,fetch(t,{method:a,body:n,headers:c});case 8:return l=e.sent,e.next=11,l.json();case 11:if(s=e.sent,l.ok){e.next=14;break}throw new Error(s.message||"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a");case 14:return r(!1),e.abrupt("return",s);case 18:throw e.prev=18,e.t0=e.catch(4),r(!1),u(e.t0.message),e.t0;case 23:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(t){return e.apply(this,arguments)}}(),[]),error:s,clearError:Object(n.useCallback)((function(){return u(null)}),[])}},_=function(){var e=y(),t=Object(o.g)(),a=I(),c=a.loading,l=a.error,u=a.request,i=a.clearError,p=Object(n.useState)({email:"",name:"",password:""}),f=Object(h.a)(p,2),b=f[0],E=f[1];Object(n.useEffect)((function(){return e(l),function(){return i()}}),[l,e,i]);var k=function(e){E(Object(v.a)({},b,Object(U.a)({},e.target.name,e.target.value)))},g=function(){var a=Object(d.a)(m.a.mark((function a(){var n;return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,u("/api/auth/register","POST",Object(v.a)({},b));case 3:n=a.sent,e(n.message),"User created."===n.message&&t.push("/auth"),a.next=10;break;case 8:a.prev=8,a.t0=a.catch(0);case 10:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(){return a.apply(this,arguments)}}();return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6 offset-s3"},r.a.createElement("h1",{className:"center"},"Users List"),r.a.createElement("div",{className:"card white darken-1"},r.a.createElement("div",{className:"card-content black-text"},r.a.createElement("span",{className:"card-title center"},"Create your account"),r.a.createElement("div",null,r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{id:"name",type:"text",name:"name",className:"validate black-input",value:b.name,onChange:k}),r.a.createElement("label",{htmlFor:"name"},"Enter name")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{id:"email",type:"text",name:"email",className:"validate black-input",value:b.email,onChange:k}),r.a.createElement("label",{htmlFor:"email"},"Enter email")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{id:"password",type:"password",name:"password",className:"validate black-input",value:b.password,onChange:k}),r.a.createElement("label",{htmlFor:"password"},"Enter password")))),r.a.createElement("div",{className:"card-action center"},r.a.createElement("div",null,r.a.createElement("span",null,"Have an account? ",r.a.createElement(s.b,{to:"/",className:"link-auth"},"Log in now "))),r.a.createElement("button",{className:"btn blue lighten-1 white-text",onClick:g,disabled:c},"SIGN UP")))))},R=function(){var e=Object(n.useContext)(f),t=y(),a=I(),c=a.error,l=a.clearError,u=a.request,o=Object(n.useState)(!1),i=Object(h.a)(o,2),p=i[0],b=i[1],E=Object(n.useState)({email:"",password:""}),k=Object(h.a)(E,2),g=k[0],w=k[1];Object(n.useEffect)((function(){return t(c),function(){return l()}}),[c,t,l]);var O=function(e){w(Object(v.a)({},g,Object(U.a)({},e.target.name,e.target.value)))},j=function(){var t=Object(d.a)(m.a.mark((function t(){var a;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return b(!0),t.prev=1,t.next=4,u("/api/auth/login","POST",Object(v.a)({},g));case 4:a=t.sent,e.login(a.token,a.userId),b(!1),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),b(!1);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}();return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6 offset-s3"},r.a.createElement("h1",{className:"center"},"Users List"),r.a.createElement("div",{className:"card white darken-1"},r.a.createElement("div",{className:"card-content black-text auth"},r.a.createElement("span",{className:"card-title center black-text"},"Sign In"),r.a.createElement("div",{className:"card-input"},r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{id:"email",type:"text",name:"email",className:"validate black-input",value:g.email,onChange:O}),r.a.createElement("label",{htmlFor:"email"},"Enter email")),r.a.createElement("div",{className:"input-field"},r.a.createElement("input",{id:"password",type:"password",name:"password",className:"validate black-input",value:g.password,onChange:O}),r.a.createElement("label",{htmlFor:"password"},"Enter password")))),r.a.createElement("div",{className:"card-action center"},r.a.createElement("div",null,r.a.createElement("span",null,"Don't have an account?",r.a.createElement(s.b,{className:"link-auth",to:"/signup"},"Sign Up"))),r.a.createElement("button",{className:"btn blue lighten-1 white-text",onClick:j,disabled:p},"Login")))))},T=function(){var e=Object(n.useContext)(f),t=Object(o.g)(),a=function(){var a=Object(d.a)(m.a.mark((function a(n){return m.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n.preventDefault(),a.next=3,e.logout();case 3:t.push("/");case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return r.a.createElement("nav",{className:"fixed-navbar"},r.a.createElement("div",{className:"nav-wrapper"},r.a.createElement("div",{className:"nav-wrapper navbar-right"},r.a.createElement(s.c,{to:"/users",className:"brand-logo left"},"Users List"),r.a.createElement("ul",{id:"nav-mobile",className:"right hide-on-med-and-down"},r.a.createElement("li",null,r.a.createElement("a",{href:"/",onClick:a},"Logout"))))))},D=a(13),B=a(25),L={loading:!1,error:null,users:[]},F=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_USERS_REQUEST":return Object(v.a)({},e,{loading:!0});case"FETCH_USERS_SUCCESS":var a=t.payload.map((function(e){return Object(v.a)({},e,{checked:!1})}));return Object(v.a)({},e,{loading:!1,users:a});case"FETCH_USERS_FAILURE":return Object(v.a)({},e,{error:t.payload});case"EDIT_USER_CHECKBOX":var n=t.payload,r=e.users,c=r.findIndex((function(e){return e.id===n}));return Object(v.a)({},e,{users:[].concat(Object(B.a)(r.slice(0,c)),[Object(v.a)({},r[c],{checked:!r[c].checked})],Object(B.a)(r.slice(c+1)))});case"EDIT_USER_ALL_CHECKBOX":for(var l=e.users,s=!0,u=0;u<l.length;u++){if(!1===l[u].checked){s=!0;break}s=!1}var o=e.users.map((function(e){return Object(v.a)({},e,{checked:s})}));return Object(v.a)({},e,{users:o});default:return e}},H=Object(D.combineReducers)({usersReducer:F}),A=a(38),J=a(39),P=Object(D.createStore)(H,Object(J.composeWithDevTools)(Object(D.applyMiddleware)(A.a))),z=function(){var e=function(){var e=Object(n.useState)(null),t=Object(h.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!1),l=Object(h.a)(c,2),s=l[0],u=l[1],o=Object(n.useState)(null),i=Object(h.a)(o,2),p=i[0],f=i[1],b=Object(n.useCallback)((function(e,t){r(e),f(t),localStorage.setItem("userData",JSON.stringify({userId:t,token:e}))}),[]),E=Object(n.useCallback)(Object(d.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=JSON.parse(localStorage.getItem("userData")).token,e.next=3,w().logoutRequest(t);case 3:r(null),f(null),localStorage.removeItem("userData");case 6:case"end":return e.stop()}}),e)}))),[]);return Object(n.useEffect)((function(){var e=JSON.parse(localStorage.getItem("userData"));e&&e.token&&b(e.token,e.userId),u(!0)}),[b]),{login:b,logout:E,token:a,userId:p,ready:s}}(),t=e.token,a=e.login,c=e.logout,l=e.userId,i=e.ready,p=!!t,E=function(e){return e?r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"/users",exact:!0,component:C}),r.a.createElement(o.a,{to:"/users"})):r.a.createElement(o.d,null,r.a.createElement(o.b,{path:"/",exact:!0,component:R}),r.a.createElement(o.b,{path:"/signup",exact:!0,component:_}),r.a.createElement(o.a,{to:"/"}))}(p);return i?r.a.createElement(u.a,{store:P},r.a.createElement(f.Provider,{value:{token:t,login:a,logout:c,userId:l,isAuthenticated:p}},r.a.createElement(s.a,null,p&&r.a.createElement(T,null),r.a.createElement("div",{className:"container"},E)))):r.a.createElement(b,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[40,1,2]]]);
//# sourceMappingURL=main.157c59ec.chunk.js.map